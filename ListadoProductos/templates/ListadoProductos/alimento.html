

  {% extends "Home/base.html" %}
  {% block title %} Inicio {% endblock %}
  {% load static %}
  {% block content %}
  <style>
    .circulo {
     width: 30px;
     height: auto;
     -moz-border-radius: 50%;
     -webkit-border-radius: 50%;
     border-radius: 50%;
     background: #5cb85c;
  }
    #alert {
      display: none;
    }
    .section-container-spacer{
      margin: auto;
    }
    header{
    width: 100%;
    height: 600px;
     background: #41515a;  /* fallback for old browsers */
     background: -webkit-linear-gradient(to right, hsla(210, 3%, 26%, 0.568), hsla(101, 28%, 74%, 0.525)), url('/static/Home/img/back-blue.png');
     /* Chrome 10-25, Safari 5.1-6 */
     background: linear-gradient(to right, hsla(210, 3%, 26%, 0.584), hsla(200, 4%, 14%, 0.545)), url('/static/Home/img/back-blue.png');
    /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
    
    background-attachment: fixed;
    position: relative;
}

.ali-container{
  width: 350px;
  height: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  color: rgb(1, 38, 71);
}
.ali-col{
  display:flex;
  width: 20px;
  height: 20px;
  border-radius: 200px 200px 200px 200px;
-moz-border-radius: 200px 200px 200px 200px;
-webkit-border-radius: 200px 200px 200px 200px;
border: 1px double #8aa339;
}
.ali-background{
  background-color:lavender
}
.rojo {
  display:flex;
  width: 20px;
  height: 20px;
  border-radius: 200px 200px 200px 200px;
  -moz-border-radius: 200px 200px 200px 200px;
  -webkit-border-radius: 200px 200px 200px 200px;
  border: 1px double #8aa339;
  background: #e01414e3;
}
.amarillo {
  display:flex;
  width: 20px;
  height: 20px;
  border-radius: 200px 200px 200px 200px;
  -moz-border-radius: 200px 200px 200px 200px;
  -webkit-border-radius: 200px 200px 200px 200px;
  border: 1px double #8aa339;
  background: #d6e411e3;
}
.verde {
  display:flex;
  width: 20px;
  height: 20px;
  border-radius: 200px 200px 200px 200px;
  -moz-border-radius: 200px 200px 200px 200px;
  -webkit-border-radius: 200px 200px 200px 200px;
  border: 1px double #8aa339;
  background: #2f8a11ca;
}


  </style>
   <!--Aviso actualizacion alimento -->
<div id="alert" class="col-xs-12 fixed-top alert alert-success alert-dismissible fade show" role="alert">
  <strong>Se actualizo el elemento</strong>
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
<!-- Cabecera-->
<header>
  <div class="texto-header">
  <h1>{{ listado.name }}</h1>
  </div>
          <div class="wave" style="height: 150px; overflow: hidden;" ><svg viewBox="0 0 500 150" preserveAspectRatio="none" style="height: 100%; width: 100%;">
              <path d="M0.00,49.99 C229.91,158.39 311.51,-47.85 500.00,49.99 L500.00,150.00 L0.00,150.00 Z" style="stroke: none; fill: rgb(248 249 250);">
               </path></svg>
          </div>
          {% if user.is_authenticated %}
          {% if favoritos %}
          <div id="check">
              <a href="{% url 'favoritos:favoritos' %}"><img id="estrella" class="img-responsive fa-icon" alt="dew" src="{% static 'Home/img/cheque.png'%}"></a></h1>
          </div>
          {% endif %}
        {% endif %}
  </header>
  <div class="row col-xs-12 section-container-spacer">
  <div class="col-xs-12">
  <!--Tabla -->
    
  <div class="opcion2">
      <div class="ali-container">
        <div class="col-5" style="background-color:rgba(75, 169, 252, 0.871);">Nombre</div>
        <div class="col-1" style="background-color:rgba(75, 169, 252, 0.871);"></div>
        <div class="col-2" style="background-color:rgba(75, 169, 252, 0.871);">bajo</div>
        <div class="col-2" style="background-color:rgba(75, 169, 252, 0.871);">med</div>
        <div class="col-2" style="background-color:rgba(75, 169, 252, 0.871);">alto</div>
      </div>
   
      <div class="ali-container">
        <div class="col-5 ali-background">Fructosa</div>
        <div class="col-1"></div>
        <div class="col-2">
          <div class="circulo {{listado.fructosa}}"></div>
        </div>
        <div class="col-2">
          <div class="ali-col circulo {{listado.fructosaAmarillo}}"></div>
        </div>
        <div class="col-2">
          <div class="ali-col circulo {{listado.fructosaRojo}}"></div>
        </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background">Lactosa</div>
      <div class="col-1"></div>
        <div class="col-2">
          <div class="circulo {{listado.lactosa}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.lactosaAmarillo}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.lactosaRojo}}"></div>
        </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background">Sorbitol</div>
      <div class="col-1"></div>
        <div class="col-2">
          <div class="circulo {{listado.sorbitol}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.sorbitolAmarillo}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.sorbitolRojo}}"></div>
        </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background">Manitol</div>
      <div class="col-1"></div>
        <div class="col-2">
          <div class="circulo {{listado.manitol}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.manitolAmarillo}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.manitolRojo}}"></div>
        </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background">GOS</div>
      <div class="col-1"></div>
      <div class="col-2">
        <div class="circulo {{listado.gos}}"></div>
      </div>
      <div class="col-2">
        <div class="circulo {{listado.gosAmarillo}}"></div>
      </div>
      <div class="col-2">
        <div class="circulo {{listado.gosRojo}}"></div>
      </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background">Fructano</div>
      <div class="col-1"></div>
        <div class="col-2">
          <div class="circulo {{listado.fructano}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.fructanoAmarillo}}"></div>
        </div>
        <div class="col-2">
          <div class="circulo {{listado.fructanoRojo}}"></div>
        </div>
    </div>
    <div class="ali-container">
      <div class="col-5 ali-background" >Gr</div>
      <div class="col-1 ali-background"></div>
        <div class="col-2 ali-background">
          <div>
            {{listado.gr}}
          </div>
        </div>
        <div class="col-2 ali-background">
          <div>
            {{listado.grAmarillo}}
          </div>
        </div>
        <div class="col-2 ali-background">
          <div>
            {{listado.grRojo}}
          </div>
        </div>
    </div>
      
    
</div>
</div>
<div class="row col-xs-12 opcion section-container-spacer">
  <div class="col-xs-12">
    <div class="opcion">
  <table class="table ">
    <thead>
      <tr>
        <th scope="col" >Nivel</th>
        <th scope="col" >Fructosa</th>
        <th scope="col" >Lactosa</th>
        <th scope="col" >Sorbitol</th>
        <th scope="col">Manitol</th>
        <th scope="col">GOS</th>
        <th scope="col">Fructano</th>
        <th scope="col" >gr</th>
      </tr>
    </thead>
       <tbody>
        <tr>
          <td >Bajo</td>
          <td class="{{listado.fructosa}}-table" ></td>
          <td class="{{listado.lactosa}}-table"></td>
          <td class="{{listado.manitol}}-table"></td>
          <td class="{{listado.sorbitol}}-table"></td>
          <td class="{{listado.gos}}-table"></td>
          <td class="{{listado.fructano}}-table"></td>
          <td>{{listado.gr}}</td>
        </tr>
        <!-- Dependiendo si existe apartado lo muestra o no en la tabla -->
        {% if listado.grAmarillo != 'false' %}
            {% if listado.grAmarillo != 'False' %}
              <tr>
                <td >Medio</td>
                <td class="{{listado.fructosaAmarillo}}-table" ></td>
                <td class="{{listado.lactosaAmarillo}}-table"></td>
                <td class="{{listado.manitolAmarillo}}-table"></td>
                <td class="{{listado.sorbitolAmarillo}}-table"></td>
                <td class="{{listado.gosAmarillo}}-table"></td>
                <td class="{{listado.fructanoAmarillo}}-table"></td>
                <td>{{listado.grAmarillo}}</td>
              </tr>
            {% endif %}
        {% endif %}
        {% if listado.grRojo != 'false' %}
            {% if listado.grRojo != 'False' %}
              <tr>
                <td>Alto</td>
                <td class="{{listado.fructosaRojo}}-table" ></td>
                <td class="{{listado.lactosaRojo}}-table"></td>
                <td class="{{listado.manitolRojo}}-table"></td>
                <td class="{{listado.sorbitolRojo}}-table"></td>
                <td class="{{listado.gosRojo}}-table"></td>
                <td class="{{listado.fructanoRojo}}-table"></td>
                <td>{{listado.grRojo}}</td>
            </tr>
            {% endif %}
        {% endif %}
    </tbody>
  </table>
</div>
</div>
</div>

   <!-- Imagen con los avisos -->
  <div class="row g-0 bg-light position-relative my-4">
      <img class="rounded col-md-10 col-lg-6 d-md-block" alt="dew" src="{{listado.thumbnail.url}}">
    
    <div class="col-xs-12 col-md-10 col-lg-6 p-md-4">
      <h5 class="mt-0">No permitido</h5>
      <p>{{listado.commentRojo}} It is intended to mimic what some real-world content would look like, and we're using it here to give the component a bit of body and size.</p>
      
      <h5 class="mt-0">Alerta</h5>
      <p>{{listado.commentAmarillo}} It is intended to mimic what some real-world content would look like, and we're using it here to give the component a bit of body and size.</p>
  
      <h5 class="mt-0">Precaucion</h5>
      <p>{{listado.commentAmarillo}} It is intended to mimic what some real-world content would look like, and we're using it here to give the component a bit of body and size.</p>
      
    </div>
  </div>
  <!-- Si el usuario esta registrado puede guardar notas y valorar el alimento -->
  
  {% if user.is_authenticated %}
<div class="row col-md-6 mx-auto my-4">
  <div class="row m-auto">
      <!-- Seleccionar la cara -->
    {% if favoritos.valor == 1 %}
      <div class="col">
        <a><img id="mareado" src="{% static 'Home/img/face/005-mareado-1.ico'%}" alt="icono-mareado"/></a>
        <a><img id="aburrido" src="{% static 'Home/img/face/001-aburrido.png'%}" alt="icono-aburrido"/></a>
        <a><img id="sonreir" src="{% static 'Home/img/face/003-sonreir.png'%}" alt="icono-sonreir"/></a>
      </div>    
    {% endif %}
    {% if favoritos.valor == 2 %}
    <div class="col">
      <a><img id="mareado"src="{% static 'Home/img/face/002-mareado.png'%}" alt="icono-mareado"/></a>
      <a><img id="aburrido"src="{% static 'Home/img/face/006-aburrido-6.png'%}" alt="icono-aburrido"/></a>
      <a><img id="sonreir"src="{% static 'Home/img/face/003-sonreir.png'%}" alt="icono-sonreir"/></a>
    </div>
    {% endif %}
    {% if favoritos.valor == 3 %}
    <div class="col">
      <a><img id="mareado" src="{% static 'Home/img/face/002-mareado.png'%}" alt="icono-mareado"/></a>
      <a><img id="aburrido" src="{% static 'Home/img/face/001-aburrido.png'%}" alt="icono-aburrido"/></a>
      <a><img id="sonreir" src="{% static 'Home/img/face/004-sonrer-4.png'%}" alt="icono-sonreir"/></a>
    </div>
    {% endif %}
    {% if favoritos.valor != 1 and favoritos.valor != 2 and favoritos.valor !=  3%}
      <a><img id="mareado" src="{% static 'Home/img/face/002-mareado.png'%}" alt="icono-mareado"/></a>
      <a><img id="aburrido"src="{% static 'Home/img/face/001-aburrido.png'%}" alt=icono-aburrido"/></a>
      <a><img id="sonreir" src="{% static 'Home/img/face/003-sonreir.png'%}" alt="icono-sonreir"/></a>
    {% endif %}
  </div>
</div>
 <!-- 
      Dejar comentario 
      Se envian datos ocultos para indentificar el alimento en servidor
-->
<table id="form_favoritos" action="" class="table">
  <tbody>
    <input type="hidden" id="id_producto" name="id_producto" value="{{ listado.id }}">
    <input type="hidden" id="name" name="name" value="{{ listado.name }}">
    <tr  class="row justify-content-md-center mx-5">
      <textarea class="form-control col-xs-12 col-md-9 m-md-auto" placeholder="Deja una nota..." name="comment" id="comment_favoritos">
        {{favoritos.comment}}
      </textarea>
    </tr>
  </tbody>
</table>
 <!-- Boton enviar -->
{% if favoritos %}
  <div class="row col-md-6 mx-auto">
    <button id="sub_update" class="btn btn-outline-primary m-auto " type="button">Actualizar</button>
  </div>
{% else %}
<div class="row col-md-6 mx-auto">
  <button id="sub" class="btn btn-outline-primary m-auto " type="button">Guardar</button>
</div>
{% endif %}
{% endif %}
<script>
// Cambiar color a las caras 
    let aburrido =  document.getElementById("aburrido");
    let mareado =  document.getElementById("mareado");
    let sonreir =  document.getElementById("sonreir");
    var num = 0;

// al hacer click se cambia la imagen
    aburrido.onclick = function(e){
      if(event.target.src.substr(-5) !== '6.png' && event.target.id == 'aburrido'){
        aburrido.setAttribute('src', "{% static 'Home/img/face/006-aburrido-6.png'%}");
        mareado.setAttribute('src', "{% static 'Home/img/face/002-mareado.png'%}");
        sonreir.setAttribute('src', "{% static 'Home/img/face/003-sonreir.png'%}");
        num = 2
      }else{
        aburrido.setAttribute('src', "{% static 'Home/img/face/001-aburrido.png'%}");
      num = 0
      }
      console.log(event.target.src.substr(-5));
      console.log(num)
    }   
    mareado.onclick = function(e){
  //Mareado
      if(event.target.src.substr(-5) !== '5.png' && event.target.id == 'mareado'){
         mareado.setAttribute('src', "{% static 'Home/img/face/005-mareado-5.png'%}");
         sonreir.setAttribute('src', "{% static 'Home/img/face/003-sonreir.png'%}");
         aburrido.setAttribute('src', "{% static 'Home/img/face/001-aburrido.png'%}");
          num = 1
       }else{
         mareado.setAttribute('src', "{% static 'Home/img/face/002-mareado.png'%}");
        num = 0
       }
       console.log(num)
    }

    sonreir.onclick = function(e){
  //Sonreir
      if(event.target.src.substr(-5) !== '4.png' && event.target.id == 'sonreir'){
         sonreir.setAttribute('src', "{% static 'Home/img/face/004-sonrer-4.png'%}");
         mareado.setAttribute('src', "{% static 'Home/img/face/002-mareado.png'%}");
         aburrido.setAttribute('src', "{% static 'Home/img/face/001-aburrido.png'%}");
          num = 3
       }else{
         sonreir.setAttribute('src', "{% static 'Home/img/face/003-sonreir.png'%}");
        num = 0
       }
       console.log(num)
      }
      
  //Guardar el alimento en la tabla Favoritos
    $("#sub").click(function(e){
        e.preventDefault();
        console.log('submit')
      let id_producto = $('input[name="id_producto"]').val().trim();
      let name = $('input[name="name"]').val().trim();
      let valor = num;
      let comment = $('#comment_favoritos').val().trim();
    
  //Peticion Ajax
        $.ajax({
            url: '/Favoritos/create-favoritos/',
            data: {
                'id_producto': id_producto,
                'name': name,
                'valor': valor,
                'comment': comment
            },
            dataType: 'json',
            success: function (data) {
              location.reload(); 
            }
        });
  });
  //Actualizar el alimento en la tabla Favoritos
  $("#sub_update").click(function(e){
         e.preventDefault();
         console.log('submit')
       let id_producto = $('input[name="id_producto"]').val().trim();
       let valor = num;
       let comment = $('#comment_favoritos').val().trim();
  //Peticion Ajax
         $.ajax({
             url: '/Favoritos/update-favoritos/',
             data: {
                 'id_producto': id_producto,
                 'valor': valor,
                 'comment': comment
             },
             dataType: 'json',
             success: function (data) {
  //Aviso cuando se actualizo el registro
              $('#alert').fadeIn();     
                setTimeout(function() {
                $("#alert").fadeOut();           
                },2000); 
             }
         });
   });
  </script> 
{% endblock %}